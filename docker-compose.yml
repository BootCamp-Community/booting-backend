# compose 파일 버전
version: '3'
services:
  # 서비스 명
  postgresql:
    # 사용할 이미지
    image: postgres
    # 컨테이너 실행 시 재시작
    restart: always
    # 컨테이너명 설정
    container_name: postgres
    # 접근 포트 설정 (컨테이너 외부:컨테이너 내부)
    ports:
      - '5432:5432'
    # 환경 변수 설정
    environment:
      # PostgreSQL 계정 및 패스워드 설정 옵션
      POSTGRES_USER: ${DOCKER_COMPOSE_DB_USER}
      POSTGRES_PASSWORD: ${DOCKER_COMPOSE_DB_PASSWORD}
    # 볼륨 설정
    volumes:
      - ./data/postgres/:/var/lib/postgresql/data
  toyserver:
    image: toy
    restart: always
    container_name: toynestjs
    ports:
      - '4000:4000'
    environment:
      POSTGRES_DB_HOST: ${POSTGRES_DB_HOST}
      POSTGRES_DB_USER: ${POSTGRES_DB_USER}
      POSTGRES_DB_PASSWORD: ${POSTGRES_DB_PASSWORD}
      POSTGRES_DB_DATABASE: ${POSTGRES_DB_DATABASE}
      POSTGRES_DB_SCHEMA: ${POSTGRES_DB_SCHEMA}
      KAKAO_LOGIN_REST_API_KEY: ${KAKAO_LOGIN_REST_API_KEY}
      KAKAO_LOGIN_ADMIN_KEY: ${KAKAO_LOGIN_ADMIN_KEY}
      NAVER_CLIENT_ID: ${NAVER_CLIENT_ID}
      NAVER_CLIENT_SECRET: ${NAVER_CLIENT_SECRET}
      JWT_SECRET_KEY: ${JWT_SECRET_KEY}
      SWAGGER_USER: ${SWAGGER_USER}
      SWAGGER_PASSWORD: ${SWAGGER_PASSWORD}
# 실행 명령어: docker compose up
